# Developer Guide

## Prerequisites

- Xcode (current project settings are generated by recent Xcode)
- Apple signing setup for device runs

## Project Layout

- App code: `reactwatch/`
- Xcode project: `reactwatch.xcodeproj`
- iOS Info plist override: `Info-iOS.plist`
- Embedded FFmpeg local package: `Vendor/FFmpegLocal`
- FFmpeg build script: `scripts/build_ffmpeg_apple.sh`
- Docs: `docs/`

## Build

```bash
xcodebuild -project reactwatch.xcodeproj -scheme reactwatch -destination 'generic/platform=macOS' build
xcodebuild -project reactwatch.xcodeproj -scheme reactwatch -destination 'generic/platform=iOS' build
```

## Run in Xcode

1. Open `reactwatch.xcodeproj`
2. Pick `reactwatch` scheme
3. Choose destination (macOS or iOS/iPadOS device/simulator)
4. Run

## FFmpeg Artifacts

Embedded remux behavior depends on local FFmpeg XCFrameworks in `Vendor/FFmpegLocal/Artifacts`.

Rebuild artifacts when needed:

```bash
scripts/build_ffmpeg_apple.sh
```

Additional details: [Local FFmpeg XCFramework Integration](ffmpeg-local.md)

## Important Runtime Areas

- UI and gestures: `ContentView.swift`
- Playback/sync core: `DualPlayerViewModel.swift`
- YouTube embed bridge: `YouTubePlayerView.swift`
- MKV remux bridge: `FFmpegRemuxer.swift`

## Configuration Notes

- Window title is set to `WadsReact`
- iOS file sharing keys live in `Info-iOS.plist`
- Converted MKV outputs are cached in app caches directory

## Known Technical Limits

- MKV path is not full decode/re-encode pipeline yet
- YouTube behavior depends on embed policy and web player constraints
- No automated test suite currently included in repository

## Suggested Development Workflow

1. Make small, isolated changes.
2. Build macOS + iOS after each feature block.
3. Validate manually in both split mode and theatre mode.
4. Verify sync behavior across:
   - local/local
   - local/YouTube
   - local/Vimeo-resolved URL
5. Re-test MKV import on representative samples.
